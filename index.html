<!DOCTYPE html>
<html lang="en">
<head>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- W3 Schools CSS -->
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
   
    
    <!-- Bootstrap CDN's -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    
</head>

<style>	
    body{
      background-color: yellow;	
      background-position: center;
      background-image: url("");
      min-height: 100%;
    }

    button {
      background-color: black;
      color: white;
      padding: 10px;
      margin: 8px 0;
      border: none;
      cursor: pointer;
      width: 18%;
      opacity: 0.9;
      border-radius: 4px;
    }
    button:hover {
      background-color: blue;
      border-radius: 4px;
      opacity: 100;
    }

    input[type=text]{
      color: white;
      width: 40%;
      padding: 10px;
      display: inline-block;
      border: none;
      background: black;
      border-radius: 4px;
    }
    
    .pagination{
    display:flex;
    margin:10px 90px;
    align-items: center;
    justify-content: center;
    color:darkRed;
    position: sticky;
    }
    
    .page{
        padding:20px;
        cursor:pointer;
    }
    
    .page.disabled{
        cursor:not-allowed;
        color:grey;
    }
    
    .current{
    padding: 10px 20px;
    border-radius: 100%;
    font-size: 20px;
    font-weight: 600;
	}
    
    
</style>

<body>
<center>

<!-- Nav Bar Section -->
<nav class="navbar navbar-inverse">
  <div class="container">
    <div class="navbar-header">
      <a class="navbar-brand" href="#">DIGITAL PREMIERES</a>
    </div>
    <ul class="nav navbar-nav">
      <li><a href="#">Home</a></li>
      <li class="dropdown">
        <a  class="dropdown-toggle" data-toggle="dropdown" href="#">Trending
        <span class="caret"></span></a>
        <ul class="dropdown-menu">
          <li><a onClick=getMovies(Trending_All_Last_24h) href="#">Today</a></li>
          <li><a onClick=getMovies(Trending_All_Last_7d) href="#">Last Week</a></li>
          <li><a onClick=getMovies(Trending_Movies_Last_24h) href="#">Movies Today</a></li>
          <li><a onClick=getMovies(Trending_Movies_Last_7d) href="#">Movies Last Week</a></li>
          <li><a onClick=getMovies(Trending_Shows_Last_24h) href="#">Movies Today</a></li>
          <li><a onClick=getMovies(Trending_Shows_Last_7d) href="#">Movies Last Week</a></li>
        </ul>
      </li>
      <li><a onClick=getMovies(Telugu_Movies) href="#">Telugu Movies</a></li>
    </ul>
	<form id="form">
            <input type="text" placeholder="Search Movie/TV Show" id="search" class="search">
            <button id="search" class="search">Search</button>
     </form>
  </div>
</nav>
<!-- /Nav Bar Section -->

<!-- SlideShow Section -->
<div id="myCarousel" class="carousel slide" data-ride="carousel">
    <!-- Indicators -->
    <ol class="carousel-indicators">
      <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
      <li data-target="#myCarousel" data-slide-to="1"></li>
      <li data-target="#myCarousel" data-slide-to="2"></li>
    </ol>
	<!-- /Indicators -->
    
    <!-- Wrapper for slides -->
    <div class="carousel-inner" role="listbox">
      <div class="item active">
        <img src="https://i.pinimg.com/564x/f6/07/3c/f6073c26e37a97549314b48f29595b84.jpg" alt="" width="800" height="200">
        <div class="carousel-caption">
          <h3>Netflix</h3>
          <p></p>
        </div>      
      </div>
      <div class="item">
        <img src="https://i.pinimg.com/564x/49/45/79/49457903ec69e585f1d0573e69b33c19.jpg" alt="" width="800" height="200">
        <div class="carousel-caption">
          <h3>Taragathi Gadhilo</h3>
          <p></p>
        </div>      
      </div>
    
      <div class="item">
        <img src="https://i.pinimg.com/564x/2e/77/23/2e7723820c5c3ae3f8ed078af5d2d445.jpg" alt="" width="800" height="200">
        <div class="carousel-caption">
          <h3>One</h3>
          <p></p>
        </div>      
      </div>
    </div>
    <!-- /Wrapper for slides -->

    <!-- Left and right controls -->
    <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
      <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
      <span class="sr-only">Previous</span>
    </a>
    <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
      <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
      <span class="sr-only">Next</span>
    </a>
    <!-- /Left and right controls -->
    
</div>
<!-- /SlideShow Section -->


<!-- Section 1

    <header>
    	<h2>Search Movie</h2>
        <form  id="form">
            <input type="text" placeholder="Search Movie/TV Show" id="search" class="search">
            <button id="search" class="search">Search</button>
        </form>
    </header>
    
 /Section 1 -->

<!-- Section Heading -->
  <div class="container">
      <h3>Movies</h3>
      <p>
      
      </p>
  </div>
<!-- /Section Heading -->

<!-- Section Main -->
    <main id="main"> 
    
    </main>
    
<!-- / Section Main -->    

<!-- Pagination 
    <div class="pagination">                               
      <div class="page" id="prev" href="#">Previous Page</div>
      <div class="current" id="current" href="#" >1</div>
      <div class="page" id="next" href="#" >Next Page</div>
    </div>
 /Pagination --> 
 



</center>
</body>

<script>

    //TMDB

    const API_KEY = 'api_key=9a85a018f878f3af62f324c75c332248';
    const BASE_URL = 'https://api.themoviedb.org/3';
    const LANG = '&language=en'



    //use the below api url for the most popular movies
    const DiscoverMovies = BASE_URL + '/discover/movie?'+ API_KEY+'&language=en-IN&region=IN';

    const DiscoverMovies_Popularity_DESC = BASE_URL + '/discover/movie?&region=IN&sort_by=popularity.desc&'+ API_KEY+'&language=en-IN';


    const Most_Popular_Movies = BASE_URL + '/discover/movie?&region=IN&sort_by=popularity.desc&'+API_KEY+'&language=en';


    // Get a list of the current popular movies on TMDB. This list updates daily.
    const Popular_Movies = BASE_URL + '/movie/popular?' + API_KEY + LANG + '&page=1' ;

    const Upcoming_Movies = BASE_URL + '/movie/upcoming?' + API_KEY + LANG + '&page=1' ;

    const Top_Rated_Movies = BASE_URL + '/movie/top_rated?' + API_KEY + LANG + '&page=1' ;

    const Movies_NowPlaying = BASE_URL + '/movie/now_playing?' + API_KEY + LANG + '&page=1' ;

    const Movies_Latest = BASE_URL + '/movie/latest?' + API_KEY;


    const Trending_All_Last_24h = BASE_URL + '/trending/all/day?' + API_KEY;

    const Trending_All_Last_7d = BASE_URL + '/trending/all/week?' + API_KEY;

    const Trending_Movies_Last_24h = BASE_URL + '/trending/movie/day?' + API_KEY;

    const Trending_Movies_Last_7d = BASE_URL + '/trending/movie/week?' + API_KEY;

    const Trending_Shows_Last_24h = BASE_URL + '/trending/tv/day?' + API_KEY;

    const Trending_Shows_Last_7d = BASE_URL + '/trending/tv/week?' + API_KEY;

    const Trending_Persons_Last_24h = BASE_URL + '/trending/person/day?' + API_KEY;

    const Trending_Persons_Last_7d = BASE_URL + '/trending/person/week?' + API_KEY;


    const Telugu_Movies = BASE_URL + '/discover/movie?&region=IN&' + API_KEY + '&with_original_language=te';

    const Tamil_Movies = BASE_URL + '/discover/movie?&region=IN&' + API_KEY + '&with_original_language=ta';

    const English_Movies = BASE_URL + '/discover/movie?&region=IN&' + API_KEY + '&with_original_language=en';

    const Hindi_Movies = BASE_URL + '/discover/movie?&region=IN&' + API_KEY + '&with_original_language=hi';

    const Malayalam_Movies = BASE_URL + '/discover/movie?' + API_KEY + '&with_original_language=ml';




    const IMG_URL = 'https://image.tmdb.org/t/p/w500';
    const IMG_URL_ORI = 'https://image.tmdb.org/t/p/original';
    const searchURL = BASE_URL + '/search/movie?'+API_KEY;

    const main = document.getElementById('main');
    const form =  document.getElementById('form');
    const search = document.getElementById('search');



    //getMovies(Trending_All_Last_24h);
    //getMovies(Trending_All_Last_7d);
    //getMovies(Trending_Movies_Last_24h);
    //getMovies(Trending_Movies_Last_7d);
    //getMovies(Trending_Shows_Last_24h);
    //getMovies(Trending_Shows_Last_7d);
    //getMovies(Trending_Persons_Last_24h);


    //OTT Movie Providers
    //getMovies("https://api.themoviedb.org/3/watch/providers/movie?api_key=9a85a018f878f3af62f324c75c332248");

    //OTT TV Providers
    //getMovies("https://api.themoviedb.org/3/watch/providers/tv?api_key=9a85a018f878f3af62f324c75c332248");


    //getMovies(Tamil_Movies)
    //getMovies(Telugu_Movies)
    getMovies(English_Movies)
    //getMovies(Hindi_Movies)
    //getMovies(Malayalam_Movies)


    // Get Movies
    function getMovies(url) {
        fetch(url).then(res => res.json()).then(data => {
            console.log(data.results)
            showMovies(data.results);

        })
    }
    
  

    // Show Movies
    function showMovies(data) {
        main.innerHTML = '';

        data.forEach(movie => {
            const {title, poster_path, backdrop_path, popularity, vote_count, vote_average, overview, release_date, adult, original_title, original_language, video, id, provider_name, logo_path} = movie;
           const movieEl = document.createElement('div');
           movieEl.classList.add('movie');
            movieEl.innerHTML = `    
            
        <div class="container col-sm-3 col-md-3 col-lg-2">
            <img class="img-responsive img-rounded"  src="${poster_path? IMG_URL + poster_path: "http://via.placeholder.com/1080x1580"  }" alt="${title} style="width:100%;"">
            <p>
            
            </p>
        </div>
            `
            main.appendChild(movieEl);
        })
    }
    

    // Vote Rating Color
    function getColor(vote) {
        if(vote>= 8){
            return 'green'
        }else if(vote >= 5){
            return "orange"
        }else{
            return 'red'
        }
    }


    // Search Function
    form.addEventListener('submit', (e) => {
        e.preventDefault();

        const searchTerm = search.value;

        if(searchTerm) {
            getMovies(searchURL+'&query='+searchTerm)
        }else{
            getMovies(API_URL);
        }
    })
    
    
    // Pagination
    prev.addEventListener('click', () => {
      if(prevPage > 0){
        pageCall(prevPage);
        form.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"})
      }
	})

	next.addEventListener('click', () => {
      if(nextPage <= totalPages){
        pageCall(nextPage);
        form.scrollIntoView({block: "start", inline: "nearest"})
      }
	})

	function pageCall(page){
      let urlSplit = lastUrl.split('?');
      let queryParams = urlSplit[1].split('&');
      let key = queryParams[queryParams.length -1].split('=');
      if(key[0] != 'page'){
        let url = lastUrl + '&page='+page
        getMovies(url);
        console.log(url)
      }
      else{
        key[1] = page.toString();
        let a = key.join('=');
        queryParams[queryParams.length -1] = a;
        let b = queryParams.join('&');
        let url = urlSplit[0] +'?'+ b
        getMovies(url);
        console.log(url)

      }
	}


</script>

</html>
